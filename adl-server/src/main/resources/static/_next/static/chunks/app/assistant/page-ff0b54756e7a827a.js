(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{85:(e,s,t)=>{Promise.resolve().then(t.bind(t,3851))},3851:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var l=t(5155),a=t(2115),r=t(2044),n=t(5418),i=t(2033),o=t(4979),c=t(878),d=t(3998),u=t(5142),m=t(7037),x=t(7614),f=t(3262),h=t(8086),p=t(5894),v=t(1186);function g(){var e,s;let[t,g]=(0,a.useState)([]),[j,b]=(0,a.useState)(""),[N,w]=(0,a.useState)(!1),[y,C]=(0,a.useState)(null),[S,k]=(0,a.useState)(null),E=(0,a.useRef)(""),_=(0,a.useRef)(null),{toast:A}=(0,p.dj)(),[q]=(0,r.IT)({query:f.g3,variables:{term:""}}),I=(null==(e=q.data)?void 0:e.list)||[],[T]=(0,r.IT)({query:f.sz}),P=(null==(s=T.data)?void 0:s.rolePrompts)||[],[R,z]=(0,r.n_)(h.of);(0,a.useEffect)(()=>{!y&&I.length>0&&C(I[0].id)},[I,y]),(0,a.useEffect)(()=>{E.current="conv-".concat(Date.now()),g([])},[y,S]),(0,a.useEffect)(()=>{if(_.current){let e=_.current.querySelector("div[data-radix-scroll-area-viewport]");e&&(e.scrollTop=e.scrollHeight)}},[t]);let D=(0,a.useCallback)(e=>{if(!y)return void A({variant:"destructive",title:"No prompt available",description:"Please create a prompt to start the conversation."});let s=[];S&&s.push({key:"role",value:S}),w(!0),z({input:{useCasesId:y,request:{messages:e.map(e=>{let{role:s,content:t,format:l}=e;return{role:s,content:t,format:l}}),userContext:{profile:[]},systemContext:s,conversationContext:{conversationId:E.current}}}}).then(e=>{let{data:s,error:t}=e;if(w(!1),t)A({variant:"destructive",title:"Error getting assistant response",description:t.message}),g(e=>[...e,{role:"assistant",content:"Sorry, I encountered an error.",format:"text"}]);else if(null==s?void 0:s.assistant){var l,a;let e=(s.assistant.messages||[]).map(e=>{let{__typename:s,...t}=e;return t}),t=null==(l=s.assistant.context)?void 0:l.map(e=>{let{__typename:s,...t}=e;return t}),r=null==(a=s.assistant.toolCalls)?void 0:a.map(e=>{let{__typename:s,...t}=e;return t});if(e.length>0){let s=e[e.length-1];"assistant"===s.role&&(t&&t.length>0&&(s.context=t),r&&r.length>0&&(s.toolCalls=r)),g(s=>[...s,...e])}else if(r&&r.length>0){let e={role:"assistant",content:"",format:"text",toolCalls:r};t&&t.length>0&&(e.context=t),g(s=>[...s,e])}}})},[z,y,A,S]);return(0,l.jsxs)("div",{className:"flex h-screen w-full flex-col bg-background",children:[(0,l.jsx)(c.default,{}),(0,l.jsxs)("main",{className:"flex flex-1 flex-col overflow-hidden",children:[(0,l.jsx)("div",{className:"border-b p-4",children:(0,l.jsxs)(v.l6,{onValueChange:e=>k("none"===e?null:e),value:S||"none",children:[(0,l.jsx)(v.bq,{className:"w-full max-w-sm mx-auto",children:(0,l.jsx)(v.yv,{placeholder:"Select a role..."})}),(0,l.jsxs)(v.gC,{children:[(0,l.jsx)(v.eb,{value:"none",children:"No Role"}),P.map(e=>(0,l.jsx)(v.eb,{value:e.id,children:e.name},e.id))]})]})}),0!==t.length||N?(0,l.jsx)(m.F,{className:"flex-1",ref:_,children:(0,l.jsxs)("div",{className:"mx-auto w-full max-w-2xl space-y-6 p-4 md:p-6",children:[t.map((e,s)=>(0,l.jsx)(x.A,{message:e},s)),N&&(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary text-primary-foreground",children:(0,l.jsx)(n.A,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{className:"flex-1 rounded-lg border p-4 text-sm bg-card flex items-center gap-2",children:[(0,l.jsx)(i.A,{className:"h-4 w-4 animate-spin"}),(0,l.jsx)("span",{children:"Thinking..."})]})]})]})}):(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center p-4 rounded-lg",children:[(0,l.jsx)(n.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,l.jsx)("h2",{className:"mt-4 text-xl font-semibold",children:"Assistant"}),(0,l.jsx)("p",{className:"mt-1 text-muted-foreground",children:"Start a conversation to begin."})]})}),(0,l.jsx)("div",{className:"border-t bg-background p-4 md:p-6",children:(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!j.trim()||N)return;let s=[...t,{role:"user",content:j,format:"text"}];g(s),D(s),b("")},className:"flex items-center gap-2 max-w-4xl mx-auto",children:[(0,l.jsx)(u.p,{value:j,onChange:e=>b(e.target.value),placeholder:"Type a message...",disabled:N||!y}),(0,l.jsxs)(d.$,{type:"submit",size:"icon",disabled:N||!j.trim()||!y,children:[(0,l.jsx)(o.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Send"})]})]})})]})]})}}},e=>{e.O(0,[330,150,34,654,878,959,441,255,358],()=>e(e.s=85)),_N_E=e.O()}]);