"use strict";(self.webpackChunkarc=self.webpackChunkarc||[]).push([[7104],{227:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"spring/graphql","title":"Agent GraphQL","description":"The Arc GraphQL Spring Boot Starter provides a GraphQL API for interacting with Arc Agents.","source":"@site/docs/05-spring/graphql.md","sourceDirName":"05-spring","slug":"/spring/graphql","permalink":"/arc/docs/spring/graphql","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Agent Beans","permalink":"/arc/docs/spring/agent-beans"},"next":{"title":"Metrics","permalink":"/arc/docs/spring/metrics"}}');var s=t(4848),a=t(8453);const i={},c="Agent GraphQL",o={},l=[{value:"Agent Subscription",id:"agent-subscription",level:3},{value:"Agent Query",id:"agent-query",level:3},{value:"Setup",id:"setup",level:3},{value:"Event Subscriptions",id:"event-subscriptions",level:3},{value:"Arc View",id:"arc-view",level:3},{value:"Graphiql",id:"graphiql",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"agent-graphql",children:"Agent GraphQL"})}),"\n",(0,s.jsx)(n.p,{children:"The Arc GraphQL Spring Boot Starter provides a GraphQL API for interacting with Arc Agents."}),"\n",(0,s.jsxs)(n.p,{children:["(Hint: Checkout the Project at ",(0,s.jsx)(n.a,{href:"https://github.com/lmos-ai/arc-spring-init",children:"https://github.com/lmos-ai/arc-spring-init"})," for a quick start.)"]}),"\n",(0,s.jsx)(n.p,{children:"Once added to a Spring Boot Application, the following endpoints are available:"}),"\n",(0,s.jsx)(n.h3,{id:"agent-subscription",children:"Agent Subscription"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Agent Subscription"})," endpoint allows you to send a request to an Agent and receive a stream of responses."]}),"\n",(0,s.jsx)(n.p,{children:"The advantage of using a graphql subscription over a standard rest/http endpoint is that the\nwebsocket connection that is created in the background is more robust against timeouts."}),"\n",(0,s.jsx)(n.p,{children:"Furthermore, the subscription enables the Agent to send multiple responses to each request.\nThis can be helpful, for example, when the Agent is executing long-running tasks and wants to provide updates to the user."}),"\n",(0,s.jsx)(n.p,{children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-graphql",children:'subscription {\n    agent(\n        agentName: "assistant-agent"\n        request: {\n            conversationContext: {\n                conversationId: "1"\n            }\n            systemContext: [],\n            userContext: {\n                userId: "1234",\n                profile: [{\n                    key: "name",\n                    value: "Pat"\n                }]\n            },\n            messages: [\n                {\n                    role: "user",\n                    content: "Hi",\n                    format: "text",\n                }\n            ]\n        }\n    ) {\n        messages {\n            content\n        }\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/arc/docs/api",children:"Arc API"})," for more details on the data models and interfaces."]}),"\n",(0,s.jsx)(n.h3,{id:"agent-query",children:"Agent Query"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Agent Query"})," endpoint returns the list of agents that are active on the server."]}),"\n",(0,s.jsx)(n.p,{children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-graphql",children:"query {\n    agent {\n        names\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,s.jsx)(n.p,{children:"Add the following dependencies to your project:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kts",children:'implementation("ai.ancf.lmos:arc-api:$arcVersion")\nimplementation("ai.ancf.lmos:arc-graphql-spring-boot-starter:$arcVersion")\nimplementation("ai.ancf.lmos:arc-spring-boot-starter:$arcVersion") // recommended\n'})}),"\n",(0,s.jsx)(n.h3,{id:"event-subscriptions",children:"Event Subscriptions"}),"\n",(0,s.jsx)(n.p,{children:"To better debug the Agents, a further graphql subscription can be enabled that provides access to\nall the events emitted by the Arc application."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-graphql",children:"subscription {\n    events {\n        type\n        payload\n        conversationId\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The feature is disabled by default. Add the following to your ",(0,s.jsx)(n.code,{children:"application.yml"})," to enable it:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"arc:\n  subscriptions:\n    events:\n      enable: true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"arc-view",children:"Arc View"}),"\n",(0,s.jsxs)(n.p,{children:["The Arc View is available at ",(0,s.jsx)(n.code,{children:"http://localhost:8080/chat/index.html"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Add the following to your ",(0,s.jsx)(n.code,{children:"application.yml"})," to enable it:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"arc:\n  chat:\n    ui:\n     enabled: true\n  subscriptions:\n    events:\n      enable: true\n"})}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/arc/docs/view",children:"Arc View"})," for more details on the UI."]}),"\n",(0,s.jsx)(n.h3,{id:"graphiql",children:"Graphiql"}),"\n",(0,s.jsxs)(n.p,{children:["The Graphiql UI is available at ",(0,s.jsx)(n.code,{children:"http://localhost:8080/graphiql?path=/graphql"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Add the following to your ",(0,s.jsx)(n.code,{children:"application.yml"})," to enable it:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"spring:\n graphql:\n   graphiql:\n    enabled: true\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>c});var r=t(6540);const s={},a=r.createContext(s);function i(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);